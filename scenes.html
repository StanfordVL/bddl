<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; BEHAVIOR Domain Definition Language  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="objects.html" />
    <link rel="prev" title="&lt;no title&gt;" href="physics_engine.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BEHAVIOR Domain Definition Language
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#id6">}</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_integration.html">ROS Integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects using Gibson/iGibson</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BEHAVIOR Domain Definition Language</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/scenes.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p># Scenes</p>
<p>### Overview
We provide four types of scenes.
- <cite>EmptyScene</cite> and <cite>StadiumScene</cite>: they are simple scenes with flat grounds and no obstacles, useful for debugging purposes.
- <cite>StaticIndoorScene</cite>: it loads static 3D scenes from <cite>igibson.g_dataset_path</cite>.
- <cite>InteractiveIndoorScene</cite>: it loads fully interactive 3D scenes from <cite>igibson.ig_dataset_path</cite>.</p>
<p>Typically, they take in the <cite>scene_id</cite> of a scene and provide a <cite>load</cite> function that be invoked externally (usually by <cite>import_scene</cite> and <cite>import_ig_scene</cite> of the <cite>Simulator</cite>).</p>
<p>To be more specific, the <cite>load</cite> function of <cite>StaticIndoorScene</cite>
- stores the floor information (we have many multistory houses in our dataset)
- loads the scene mesh into PyBullet
- builds an internal traversability graph for each floor based on the traversability maps stored in the scene folder (e.g. <cite>dataset/Rs/floor_trav_0.png</cite>)
- provides APIs for sampling a random location in the scene, and for computing the shortest path between two locations in the scene.</p>
<p>In addition to everything mentioned above, the <cite>load</cite> function of <cite>InteractiveIndoorScene</cite> also
- provides material/texture randomization functionality: randomize the material, texture and dynamic property of scene object models
- provides object randomization functionality: randomize scene object models while keeping object poses and categories intact
- provides scene quality check: check if object models have collisions and if fixed, articulated objects can extend their joints fully without collision
- provides partial scene loading functionality: 1) only load objects of certain categories, 2) only load objects in certain room types, 3) only load objects in certain room instances.
- provides APIs for changing the state of articulated objects (e.g. open all “fridges” and “ovens” in the scene)</p>
<p>Most of the code can be found here: [igibson/scenes](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/scenes">https://github.com/StanfordVL/iGibson/blob/master/igibson/scenes</a>).</p>
<p>### Adding other scenes to iGibson
We provide detailed instructions and scripts to import scenes from the following sources into iGibson:
1. [CubiCasa5k](<a class="reference external" href="https://github.com/CubiCasa/CubiCasa5k">https://github.com/CubiCasa/CubiCasa5k</a>): A Dataset and an Improved Multi-Task Model for Floorplan Image Analysis. (Kalervo, Ahti, et al.)
2. [3D-FRONT](<a class="reference external" href="https://tianchi.aliyun.com/specials/promotion/alibaba-3d-scene-dataset">https://tianchi.aliyun.com/specials/promotion/alibaba-3d-scene-dataset</a>): 3D Furnished Rooms with layOuts and semaNTics. (Fu, Huanl, et al.)</p>
<p>Instruction can be found here: [External Scenes](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/utils/data_utils/ext_scene">https://github.com/StanfordVL/iGibson/blob/master/igibson/utils/data_utils/ext_scene</a>).</p>
<p>### Examples</p>
<p>#### Stadium Scenes</p>
<p>In this example, we import a simple stadium scene that is good for debugging. The code can be found here: [igibson/examples/demo/scene_stadium_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_stadium_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_stadium_example.py</a>).</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
from igibson.scenes.stadium_scene import StadiumScene
import pybullet as p
import numpy as np
import time</p>
<dl>
<dt>def main():</dt><dd><p>p.connect(p.GUI)
p.setGravity(0,0,-9.8)
p.setTimeStep(1./240.)</p>
<p>scene = StadiumScene()
scene.load()</p>
<dl class="simple">
<dt>for _ in range(24000):  # at least 100 seconds</dt><dd><p>p.stepSimulation()
time.sleep(1./240.)</p>
</dd>
</dl>
<p>p.disconnect()</p>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>main()</p>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>The stadium scene looks like this:
![scene_stadium](images/scene_stadium.png)</p>
<p>#### Static Building Scenes</p>
<p>In this example, we import a static scene, and then randomly sample a pair of locations in the scene and compuete the shortest path between them. The code can be found here: [igibson/examples/demo/scene_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_example.py</a>).</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
from igibson.scenes.gibson_indoor_scene import StaticIndoorScene
import pybullet as p
import numpy as np
import time</p>
<dl>
<dt>def main():</dt><dd><p>p.connect(p.GUI)
p.setGravity(0,0,-9.8)
p.setTimeStep(1./240.)</p>
<dl class="simple">
<dt>scene = BuildingScene(‘Rs’,</dt><dd><p>build_graph=True,
pybullet_load_texture=True)</p>
</dd>
</dl>
<p>scene.load()</p>
<p>np.random.seed(0)
for _ in range(10):</p>
<blockquote>
<div><p>random_floor = scene.get_random_floor()
p1 = scene.get_random_point(floor=random_floor)[1]
p2 = scene.get_random_point(floor=random_floor)[1]
shortest_path, geodesic_distance = scene.get_shortest_path(random_floor, p1[:2], p2[:2], entire_path=True)
print(‘random point 1:’, p1)
print(‘random point 2:’, p2)
print(‘geodesic distance between p1 and p2’, geodesic_distance)
print(‘shortest path from p1 to p2:’, shortest_path)</p>
</div></blockquote>
<dl class="simple">
<dt>for _ in range(24000):  # at least 100 seconds</dt><dd><p>p.stepSimulation()
time.sleep(1./240.)</p>
</dd>
</dl>
<p>p.disconnect()</p>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>main()</p>
</dd>
</dl>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>#### Interactive Building Scenes
In this example, we import a fully interactive scene, and randomly sample points given a room type such as “living_room”. This can be useful for tasks that require the robot to always be spawned in certain room types. We support fifteen such scenes right now as part of the new iGibson Dataset. The code can be found here: [igibson/examples/demo/scene_interactive_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_example.py</a>).</p>
<p>Note that all objects in these scenes can be interacted realistically.
![scene_interactive.png](images/scene_interactive.png)</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>python
from igibson.scenes.igibson_indoor_scene import InteractiveIndoorScene
from igibson.simulator import Simulator
import numpy as np</p>
<dl>
<dt>def main():</dt><dd><dl class="simple">
<dt>s = Simulator(mode=’gui’, image_width=512,</dt><dd><p>image_height=512, device_idx=0)</p>
</dd>
<dt>scene = InteractiveIndoorScene(</dt><dd><p>‘Rs_int’, texture_randomization=False, object_randomization=False)</p>
</dd>
</dl>
<p>s.import_ig_scene(scene)</p>
<p>np.random.seed(0)
for _ in range(10):</p>
<blockquote>
<div><p>pt = scene.get_random_point_by_room_type(‘living_room’)[1]
print(‘random point in living_room’, pt)</p>
</div></blockquote>
<dl class="simple">
<dt>for _ in range(1000):</dt><dd><p>s.step()</p>
</dd>
</dl>
<p>s.disconnect()</p>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>main()</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>##### Texture Randomization
In this example, we demonstrate material/texture randomization functionality of <cite>InteractiveIndoorScene</cite>. The goal is to randomize the material, texture and dynamic properties of all scene objects by calling <cite>scene.randomize_texture</cite> on-demand. The code can be found here: [igibson/examples/demo/scene_interactive_texture_rand_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_texture_rand_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_texture_rand_example.py</a>).</p>
<p>The randomized materials in the <cite>ExternalView</cite> window should look like this.
![scene_interactive_texture_rand](images/scene_interactive_texture_rand.png)</p>
<p>##### Object Randomization
In this example, we demonstrate object randomization functionality of <cite>InteractiveIndoorScene</cite>. The goal is to randomize the object models while maintaining their poses and categories. Note that when object models are randomized, there is no guarantee that they have no collisions or the fixed, articulated objects can extend their joints without collision. We provide <cite>scene.check_scene_quality</cite> functionality to check scene quality and you should do object model re-sampling if this function returns <cite>False</cite>. An alternative way (recommended) is to use randoml object model configuration that we provide (10 for each scenes) which guarantees scene quality, by passing in <cite>object_randomization_idx=[0-9]</cite>. Finally, object randomization can be expensive because the new object models need to be loaded to the simulator each time, so we recommend only using it occasionally (e.g. every 1000 training episodes). The code can be found here: [igibson/examples/demo/scene_interactive_object_rand_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_object_rand_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_object_rand_example.py</a>).</p>
<p>The randomized object models in the <cite>ExternalView</cite> window should look like this.
![scene_interactive_object_rand](images/scene_interactive_object_rand.png)</p>
<p>##### Partial Scene Loading
In this example, we demonstrate partial scene loading functionality of <cite>InteractiveIndoorScene</cite>. Specifically in this example we only load “chairs” in “living rooms”. This can be useful for tasks that only require certain object categories or rooms. The code can be found here: [igibson/examples/demo/scene_interactive_partial_loading_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_partial_loading_example.py">https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/demo/scene_interactive_partial_loading_example.py</a>).</p>
<p>#### Visualize Traversability Map</p>
<p>In this example, we visuliaze the traversability map of a scene. We use this map to build an internal traversability graph for each floor so that we can compute the shortest path between two locations, and place robots and objects at valid locations inside the scene. The code can be found here: [igibson/examples/demo/trav_map_vis_example.py](<a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/examples/trav_map_vis_example.py">https://github.com/StanfordVL/iGibson/blob/master/examples/trav_map_vis_example.py</a>).</p>
<p>The traversability map of the scene <cite>Rs</cite> looks like this:
![trav_map_vis](images/trav_map_vis.png)</p>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="physics_engine.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="objects.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Stanford University 2018-2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>